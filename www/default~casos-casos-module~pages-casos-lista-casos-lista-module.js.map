{"version":3,"sources":["webpack:///./src/app/services/casos.service.ts","webpack:///./src/app/services/usuario.service.ts"],"names":[],"mappings":"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","file":"default~casos-casos-module~pages-casos-lista-casos-lista-module.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { URL_SERVICIOS } from \"../config/url.servicios\";\nimport { AjustesService } from './ajustes.service';\nimport 'rxjs/add/operator/map';\nimport { HttpClient } from '@angular/common/http';\nimport { ICasos, Caso} from '../interfaces/casos';\nimport { IComentarios, Comentario} from '../interfaces/comentarios';\nimport { async } from '@angular/core/testing';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CasosService {\n  casos: Caso[];\n  comentarios: Comentario[];\n\n  constructor(\n    private http: HttpClient,\n    private _as:AjustesService\n  ) { }\n  async cargar_todos() {\n      \n    let url = URL_SERVICIOS + \"/casosC.php\";\n    let promesa = await this.http.get<ICasos>(url)\n      .toPromise()\n      .then(data => {\n        this.casos =  data.casos;\n        return this.casos;\n      })\n      .catch(error => {\n        this._as.loading.dismiss();\n        return Promise.reject(error);\n      });\n    return promesa;\n  \n}\nasync getCaso(id:any) {\n      \n  let url = URL_SERVICIOS + \"/casosC.php?id=\"+id;\n  let promesa = await this.http.get<ICasos>(url)\n    .toPromise()\n    .then(data => {\n      this.casos =  data.casos;\n      return this.casos;\n    })\n    .catch(error => {\n      this._as.loading.dismiss();\n      return Promise.reject(error);\n    });\n  return promesa;\n\n}\n\n\nasync setComentario(socio_id: number, caso_id: number, comentario:string ) {\n\n  return new Promise(resolve => {\n    let url = URL_SERVICIOS + \"/setComentario.php\";\n    this.http.post(url, {'socio_id':socio_id, 'caso_id':caso_id,'comentario':comentario})\n      .subscribe(resp => {\n        if (!resp['error']) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n\n      });\n  });\n}\n  async getComentarios(caso:any){\n          \n  let url = URL_SERVICIOS + \"/comentarios.php?caso=\"+caso;\n  let promesa = await this.http.get<IComentarios>(url)\n    .toPromise()\n    .then(data => {\n      this.comentarios =  data.comentarios;\n      return this.comentarios;\n    })\n    .catch(error => {\n      this._as.loading.dismiss();\n      return Promise.reject(error);\n    });\n  return promesa;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Storage } from '@ionic/storage';\nimport { HttpClient } from '@angular/common/http';\nimport { URL_SERVICIOS } from \"../config/url.servicios\";\nimport { AjustesService } from './ajustes.service';\nimport { NavController } from '@ionic/angular';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UsuarioService {\n  token: string = null;\n  private usuario: IUsuario = {};\n\n  constructor(\n    private storage: Storage,\n    private http: HttpClient,\n    private _as: AjustesService,\n    private navCtrl: NavController\n  ) {\n\n  }\n\n  login(email: string, password: string) {\n    const data = { email, password };\n    let url = URL_SERVICIOS + \"/login.php\";\n    return new Promise(resolve => {\n      this.http.post(url, data).subscribe(\n        resp => {\n          console.log(resp);\n          if (!resp['error']) {\n            this.guardarToken(resp['token']);\n            resolve(true);\n          } else {\n            this._as.presentAlert(resp['mensaje']);\n            this.token = null;\n            this.storage.remove('token');\n            resolve(false);\n          }\n        }\n      )\n    });\n  }\n\n  registro(usuario: IUsuario) {\n    let url = URL_SERVICIOS + \"/registro.php\";\n    return new Promise(resolve => {\n      this.http.post(url, usuario).subscribe(\n        resp => {\n          console.log(resp);\n          if (!resp['error']) {\n            this.guardarToken(resp['token']);\n            resolve(true);\n          } else {\n            this._as.presentAlert(resp['mensaje']);\n            this.token = null;\n            this.storage.remove('token');\n            resolve(false);\n          }\n        }\n      )\n    });\n  }\n\n\n\n  async getUsuario() {\n      await this.validaToken();\n    return await { ...this.usuario };\n  }\n\n  async guardarToken(token: string) {\n    this.token = token;\n    await this.storage.set('token', token);\n  }\n\n  async cargarToken() {\n    this.token = await this.storage.get('token') || null;\n  }\n\n  async existeToken(): Promise<boolean> {\n    await this.cargarToken();\n    if (!this.token) {\n      console.log(\"No existe token\");\n      return Promise.resolve(false);\n    } else {\n      console.log(\"Si existe token\");\n      return Promise.resolve(true);\n    }\n  }\n\n  async tienePermiso(): Promise<boolean> {\n    await this.cargarToken();\n    if (!this.token) {\n      //this._as.presentAlert(\"Ir a mi perfil para registrarme\");\n      return Promise.resolve(false);\n    } else {\n      console.log(\"Si existe token\");\n      return Promise.resolve(true);\n    }\n  }\n\n\n  async validaToken(): Promise<boolean> {\n\n    await this.cargarToken();\n\n    if (!this.token) {\n      this.navCtrl.navigateRoot('/tabs/login');\n      return Promise.resolve(false);\n    }\n\n\n    return new Promise<boolean>(resolve => {\n      let url = URL_SERVICIOS + \"/usuario.php\";\n      const data = { token: this.token };\n      this.http.post(url, data)\n        .subscribe(resp => {\n          if (resp['id']) {\n            this.usuario = resp;\n            resolve(true);\n          } else {\n            this.navCtrl.navigateRoot('/tabs/login');\n            resolve(false);\n          }\n        });\n    });\n\n  }\n\n\n  logout() {\n    this.token = null;\n    this.usuario = null;\n    this.storage.remove('token');\n    this.navCtrl.navigateRoot('/tabs/login', { animated: true });\n  }\n\n\n  actualizarUsuario(usuario: IUsuario) {\n\n    return new Promise(resolve => {\n      let url = URL_SERVICIOS + \"/updateuser.php\";\n      this.http.post(url, usuario)\n        .subscribe(resp => {\n          if (resp['success']) {\n            resolve(true);\n          } else {\n            resolve(false);\n          }\n\n        });\n\n    });\n\n\n\n  }\n}\n"],"sourceRoot":""}